# Control Points File Format

## Curves

The text file should include a list of _(x, y)_ coordinates. For instance, `CP_Curve1.txt` file contains the following control points:

* 05,10
* 15,25
* 30,30
* 45,05
* 55,05
* 70,40
* 60,60
* 35,60
* 20,40

Therefore, the format of the control points file is;

| x  | y  |
| :---: | :---: |
| 05 | 10 |
| 15 | 25 |
| 30 | 30 |
| 45 | 05 |
| 55 | 05 |
| 70 | 40 |
| 60 | 60 |
| 35 | 60 |
| 20 | 40 |

In order to generate the weighted control points file structure, you should multiply x and y values by the weight, _"w"_. An example file, `CPw_Curve4.txt`, is shown below:

| x\*w | y\*w | w |
| :---: | :---: | :---: |
| 0 | -1 | 1 |
| -0.707 | -0.707 | 0.707 |
| -1 | 0 | 1 |
| -0.707 | 0.707 | 0.707 |
| 0 | 1 | 1 |
| 0.707 | 0.707 | 0.707 |
| 1 | 0 | 1 |
| 0.707 | -0.707 | 0.707 |
| 0 | -1 | 1| 

The unweighted version of `CPw_Curve4.txt` file is;

| x  | y  |
| :---: | :---: |
| 0 | -1 |
| -1 | -1 |
| -1 | 0 |
| -1 | 1 |
| 0 | 1 |
| 1 | 1 |
| 1 | 0 |
| 1 | -1 |
| 0 | -1 |

The method to read control points from the files structured like the above are;

* `read_ctrlpts(file_name)` for files containing _(x, y)_ style control points.
* `read_ctrlptsw(file_name)` for files containing _(x\*w, y\*w, w)_ style weighted control points.

## JSON format

Alternatively, nurbs data can be loaded from a JSON file. In this case, the control points are required (non-weighted), and weights and knots are optional. If no weights vector is provided they default to 1, and if no knot vector is provided it will be autogenerated.

```json
{
    "degree": 3,
    "controlpoints":{
        "x" : [ 0, 0, 2, 3, 3.5, 2, 2, 4],
        "y" : [ 0, 2, 2.5, 1, 2.5, 3, 4, 3]
    },
    "weights": [1.4, 0.5, 1.6, 1.8, 0.7, 1.9, 1.5, 0.9],
    "knotvector": [0.0, 0.0, 0.0, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.0, 1.0, 1.0, 1.0]
}
```

## Surfaces

The text file should include _(x, y, z)_ coordinates. The structure of the text file includes two directions, namely **u** and **v**.

Therefore, the format of the control points file is;

| | u0 | u1 | u2 | u3 | u4 | u5 | u6 | u7 | u8 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **v0** | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ |
| **v1** | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ |
| **v2** | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ |
| **v3** | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ |
| **v4** | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ |
| **v5** | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ |
| **v6** | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ |
| **v7** | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ |
| **v8** | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ | _(x, y, z)_ |

The format of the weighted control points file is;

| | u0 | u1 | u2 | u3 |
| :---: | :---: | :---: | :---: | :---: |
| **v0** | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | 
| **v1** | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | 
| **v2** | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | 
| **v3** | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ | _(x\*w, y\*w, z\*w, w)_ |

The methods to read control points from the files structured like the above are

* `read_ctrlpts(file_name)` for files containing _(x, y, z)_ style control points.
* `read_ctrlptsw(file_name)` for files containing _(x\*w, y\*w, z\*w, w)_ style weighted control points.

## JSON format

Alternatively, nurbs data can be loaded from a JSON file. In this case, the control points are required (non-weighted), and weights and knots are optional. If no weights vector is provided they default to 1, and if no knot vector is provided it will be autogenerated. All flattened arrays are in v-major convention, similar to the above matrix for txt input.

```json
{
    "dim" : [6, 6],
    "controlpoints":{
        "x" : [-25,-25,-25,-25,-25,-25,-15,-15,-15,-15,-15,-15,-5,-5,-5,-5,-5,-5,5,5,5,5,5,5,15,15,15,15,15,15,25,25,25,25,25,25],
        "y" : [-25,-15,-5,5,15,25,-25,-15,-5,5,15,25,-25,-15,-5,5,15,25,-25,-15,-5,5,15,25,-25,-15,-5,5,15,25,-25,-15,-5,5,15,25],
        "z" : [-10,-5,0,0,-5,-10,-8,-4,-4,-4,-4,-8,-5,-3,-8,-8,-3,-5,-3,-2,-8,-8,-2,-3,-8,-4,-4,-4,-4,-8,-10,-5,2,2,-5,-10]
    },
    "degree": [3, 3],    
    "knots":{
        "u" : [0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 3.0, 3.0, 3.0, 3.0],
        "v" : [0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 3.0, 3.0, 3.0, 3.0]
    },
    "weights": [1.0,1.0,1.0,0.5,0.5,0.5,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.5,1.5,1.5,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]
}
```

**Note:** The file formats correspond to a right-handed coordinate system.
